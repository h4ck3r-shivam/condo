// auto generated by kmigrator
// KMIGRATOR:0418_payment_payment_period_status_org:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDUuMC43IG9uIDIwMjQtMDgtMTMgMjA6NDcKCmltcG9ydCBkamFuZ28uY29udHJpYi5wb3N0Z3Jlcy5pbmRleGVzCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zCgoKY2xhc3MgTWlncmF0aW9uKG1pZ3JhdGlvbnMuTWlncmF0aW9uKToKCiAgICBkZXBlbmRlbmNpZXMgPSBbCiAgICAgICAgKCdfZGphbmdvX3NjaGVtYScsICcwNDE3X2JpbGxpbmdyZWNlaXB0X2JpbGxpbmdyZWNlaXB0X3BlcmlvZF9jb250ZXh0JyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkFkZEluZGV4KAogICAgICAgICAgICBtb2RlbF9uYW1lPSdwYXltZW50JywKICAgICAgICAgICAgaW5kZXg9ZGphbmdvLmNvbnRyaWIucG9zdGdyZXMuaW5kZXhlcy5CVHJlZUluZGV4KGZpZWxkcz1bJ3BlcmlvZCcsICdzdGF0dXMnLCAnb3JnYW5pemF0aW9uJ10sIG5hbWU9J3BheW1lbnRfcGVyaW9kX3N0YXR1c19vcmcnKSwKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- [CUSTOM] Set Statement Timeout to some large amount - 25 min (25 * 60 => 1500 sec)
--
SET statement_timeout = '1500s';
--
-- [CUSTOM] Create index payment_period_status_org on field(s) period, status, organization of model payment
--
CREATE INDEX IF NOT EXISTS "payment_period_status_org" ON "Payment" USING btree ("period", "status", "organization") WHERE ("deletedAt" IS null);
--
-- [CUSTOM] Revert Statement Timeout to default amount - 10 secs
--
SET statement_timeout = '10s';
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- [CUSTOM] Set Statement Timeout to some large amount - 25 min (25 * 60 => 1500 sec)
--
SET statement_timeout = '1500s';
--
-- Create index payment_period_status_org on field(s) period, status, organization of model payment
--
DROP INDEX IF EXISTS "payment_period_status_org";
--
-- [CUSTOM] Revert Statement Timeout to default amount - 10 secs
--
SET statement_timeout = '10s';
COMMIT;

    `)
}
